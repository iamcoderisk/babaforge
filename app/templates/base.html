<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>{% block title %}SendBaba{% endblock %}</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
    <style>
        .sidebar-link { transition: all 0.2s; }
        .sidebar-link:hover { background: rgba(139, 92, 246, 0.1); }
        .sidebar-link.active { background: rgba(139, 92, 246, 0.15); border-left: 3px solid #8B5CF6; }
        #mobileSidebar { transform: translateX(-100%); transition: transform 0.3s; }
        #mobileSidebar.show { transform: translateX(0); }
    </style>
</head>
<body class="bg-gray-50">
{% if current_user.is_authenticated and request.path.startswith('/dashboard') %}
<div class="flex h-screen">
    <!-- Desktop Sidebar -->
    <aside class="w-64 bg-white border-r hidden md:block">
        <div class="p-6 border-b">
            <a href="/" class="flex items-center space-x-2">
                <div class="w-8 h-8 bg-purple-600 rounded-lg flex items-center justify-center">
                    <i class="fas fa-paper-plane text-white text-sm"></i>
                </div>
                <span class="text-xl font-bold">SendBaba</span>
            </a>
        </div>
        <nav class="p-4">
            <ul class="space-y-1">
                <li><a href="{{ url_for('dashboard.index') }}" class="sidebar-link flex items-center px-4 py-3 rounded-lg {% if request.endpoint == 'dashboard.index' %}active{% endif %}"><i class="fas fa-th-large w-5"></i><span class="ml-3">Dashboard</span></a></li>
                <li><a href="{{ url_for('dashboard.send_email') }}" class="sidebar-link flex items-center px-4 py-3 rounded-lg {% if request.endpoint == 'dashboard.send_email' %}active{% endif %}"><i class="fas fa-envelope w-5"></i><span class="ml-3">Send Email</span></a></li>
                <li><a href="{{ url_for('dashboard.bulk_send') }}" class="sidebar-link flex items-center px-4 py-3 rounded-lg {% if request.endpoint == 'dashboard.bulk_send' %}active{% endif %}"><i class="fas fa-paper-plane w-5"></i><span class="ml-3">Campaigns</span></a></li>
                <li><a href="{{ url_for('dashboard.contacts') }}" class="sidebar-link flex items-center px-4 py-3 rounded-lg {% if request.endpoint == 'dashboard.contacts' %}active{% endif %}"><i class="fas fa-users w-5"></i><span class="ml-3">Contacts</span></a></li>
                <li><a href="{{ url_for('dashboard.domains') }}" class="sidebar-link flex items-center px-4 py-3 rounded-lg {% if request.endpoint == 'dashboard.domains' %}active{% endif %}"><i class="fas fa-globe w-5"></i><span class="ml-3">Domains</span></a></li>
                <li><a href="{{ url_for('dashboard.analytics') }}" class="sidebar-link flex items-center px-4 py-3 rounded-lg {% if request.endpoint == 'dashboard.analytics' %}active{% endif %}"><i class="fas fa-chart-line w-5"></i><span class="ml-3">Analytics</span></a></li>
                <li><a href="{{ url_for('dashboard.settings') }}" class="sidebar-link flex items-center px-4 py-3 rounded-lg {% if request.endpoint == 'dashboard.settings' %}active{% endif %}"><i class="fas fa-cog w-5"></i><span class="ml-3">Settings</span></a></li>
            </ul>
        </nav>
        <div class="absolute bottom-0 left-0 right-0 p-4 border-t bg-white w-64">
            <div class="flex items-center justify-between">
                <div class="flex items-center min-w-0">
                    <div class="w-8 h-8 bg-purple-600 rounded-full flex items-center justify-center text-white text-sm font-medium flex-shrink-0">
                        {{ current_user.email[0].upper() }}
                    </div>
                    <div class="ml-3 min-w-0">
                        <div class="text-sm font-medium text-gray-900 truncate">{{ current_user.email }}</div>
                    </div>
                </div>
                <a href="{{ url_for('auth.logout') }}" class="text-gray-400 hover:text-gray-600 flex-shrink-0 ml-2" title="Logout">
                    <i class="fas fa-sign-out-alt"></i>
                </a>
            </div>
        </div>
    </aside>
    
    <!-- Mobile Sidebar -->
    <aside id="mobileSidebar" class="fixed inset-y-0 left-0 w-64 bg-white border-r z-50 md:hidden">
        <div class="p-6 border-b flex justify-between items-center">
            <a href="/" class="flex items-center space-x-2">
                <div class="w-8 h-8 bg-purple-600 rounded-lg flex items-center justify-center">
                    <i class="fas fa-paper-plane text-white text-sm"></i>
                </div>
                <span class="text-xl font-bold">SendBaba</span>
            </a>
            <button onclick="toggleMobile()" class="text-gray-500">
                <i class="fas fa-times text-xl"></i>
            </button>
        </div>
        <nav class="p-4">
            <ul class="space-y-1">
                <li><a href="{{ url_for('dashboard.index') }}" class="sidebar-link flex items-center px-4 py-3 rounded-lg"><i class="fas fa-th-large w-5"></i><span class="ml-3">Dashboard</span></a></li>
                <li><a href="{{ url_for('dashboard.send_email') }}" class="sidebar-link flex items-center px-4 py-3 rounded-lg"><i class="fas fa-envelope w-5"></i><span class="ml-3">Send Email</span></a></li>
                <li><a href="{{ url_for('dashboard.bulk_send') }}" class="sidebar-link flex items-center px-4 py-3 rounded-lg"><i class="fas fa-paper-plane w-5"></i><span class="ml-3">Campaigns</span></a></li>
                <li><a href="{{ url_for('dashboard.contacts') }}" class="sidebar-link flex items-center px-4 py-3 rounded-lg"><i class="fas fa-users w-5"></i><span class="ml-3">Contacts</span></a></li>
                <li><a href="{{ url_for('dashboard.domains') }}" class="sidebar-link flex items-center px-4 py-3 rounded-lg"><i class="fas fa-globe w-5"></i><span class="ml-3">Domains</span></a></li>
                <li><a href="{{ url_for('dashboard.analytics') }}" class="sidebar-link flex items-center px-4 py-3 rounded-lg"><i class="fas fa-chart-line w-5"></i><span class="ml-3">Analytics</span></a></li>
            </ul>
        </nav>
        <div class="absolute bottom-0 left-0 right-0 p-4 border-t bg-white w-64">
            <div class="flex items-center justify-between">
                <div class="flex items-center min-w-0">
                    <div class="w-8 h-8 bg-purple-600 rounded-full flex items-center justify-center text-white text-sm font-medium flex-shrink-0">
                        {{ current_user.email[0].upper() }}
                    </div>
                    <div class="ml-3 min-w-0">
                        <div class="text-sm font-medium text-gray-900 truncate">{{ current_user.email }}</div>
                    </div>
                </div>
                <a href="{{ url_for('auth.logout') }}" class="text-gray-400 hover:text-gray-600 flex-shrink-0 ml-2" title="Logout">
                    <i class="fas fa-sign-out-alt"></i>
                </a>
            </div>
        </div>
    </aside>
    
    <!-- Mobile Overlay -->
    <div id="mobileOverlay" class="hidden fixed inset-0 bg-black bg-opacity-50 z-40 md:hidden" onclick="toggleMobile()"></div>
    
    <div class="flex-1 overflow-y-auto">
        <!-- Mobile Header -->
        <header class="bg-white border-b p-4 md:hidden flex justify-between items-center">
            <button onclick="toggleMobile()" class="text-gray-600">
                <i class="fas fa-bars text-xl"></i>
            </button>
            <span class="font-bold text-lg">SendBaba</span>
            <a href="{{ url_for('auth.logout') }}" class="text-gray-600">
                <i class="fas fa-sign-out-alt"></i>
            </a>
        </header>
{% else %}
<nav class="bg-white border-b sticky top-0 z-50 shadow-sm">
    <div class="max-w-7xl mx-auto px-4">
        <div class="flex justify-between h-16">
            <div class="flex items-center">
                <a href="/" class="flex items-center space-x-2">
                    <div class="w-8 h-8 bg-purple-600 rounded-lg flex items-center justify-center">
                        <i class="fas fa-paper-plane text-white text-sm"></i>
                    </div>
                    <span class="text-xl font-bold">SendBaba</span>
                </a>
                <div class="hidden sm:ml-8 sm:flex sm:space-x-8">
                    <a href="{{ url_for('main.features') }}" class="text-gray-700 hover:text-purple-600 text-sm">Features</a>
                    <a href="{{ url_for('main.pricing') }}" class="text-gray-700 hover:text-purple-600 text-sm">Pricing</a>
                    <a href="{{ url_for('main.docs') }}" class="text-gray-700 hover:text-purple-600 text-sm">Docs</a>
                </div>
            </div>
            <div class="flex items-center space-x-4">
                {% if current_user.is_authenticated %}
                <a href="{{ url_for('dashboard.index') }}" class="text-gray-700">Dashboard</a>
                <a href="{{ url_for('auth.logout') }}" class="text-gray-500">Logout</a>
                {% else %}
                <a href="{{ url_for('auth.login') }}" class="text-gray-700">Login</a>
                <a href="{{ url_for('auth.signup') }}" class="bg-purple-600 text-white px-4 py-2 rounded-lg text-sm">Sign Up</a>
                {% endif %}
            </div>
        </div>
    </div>
</nav>

<!-- Mobile Menu (Public) -->
<div id="publicMobileMenu" class="hidden sm:hidden bg-white border-b shadow-lg">
    <div class="px-4 py-2 space-y-1">
        <a href="{{ url_for('main.features') }}" class="block px-3 py-2 text-gray-700 hover:bg-gray-50 rounded">Features</a>
        <a href="{{ url_for('main.pricing') }}" class="block px-3 py-2 text-gray-700 hover:bg-gray-50 rounded">Pricing</a>
        <a href="{{ url_for('main.docs') }}" class="block px-3 py-2 text-gray-700 hover:bg-gray-50 rounded">Docs</a>
        {% if current_user.is_authenticated %}
        <a href="{{ url_for('dashboard.index') }}" class="block px-3 py-2 text-gray-700 hover:bg-gray-50 rounded">Dashboard</a>
        <a href="{{ url_for('auth.logout') }}" class="block px-3 py-2 text-gray-700 hover:bg-gray-50 rounded">Logout</a>
        {% else %}
        <a href="{{ url_for('auth.login') }}" class="block px-3 py-2 text-gray-700 hover:bg-gray-50 rounded">Login</a>
        <a href="{{ url_for('auth.signup') }}" class="block px-3 py-2 bg-purple-600 text-white hover:bg-purple-700 rounded">Sign Up</a>
        {% endif %}
    </div>
</div>
{% endif %}
{% with messages = get_flashed_messages(with_categories=true) %}
{% if messages %}
<div class="p-4">
    {% for category, message in messages %}
    <div class="rounded p-3 mb-2 {% if category == 'error' %}bg-red-50 text-red-800{% else %}bg-green-50 text-green-800{% endif %}">{{ message }}</div>
    {% endfor %}
</div>
{% endif %}
{% endwith %}
{% block content %}{% endblock %}
{% if not (current_user.is_authenticated and request.path.startswith('/dashboard')) %}
<footer class="bg-white border-t mt-12">
    <div class="max-w-7xl mx-auto py-8 px-4">
        <p class="text-center text-gray-500 text-sm">Â© 2025 SendBaba</p>
    </div>
</footer>
{% endif %}
{% if current_user.is_authenticated and request.path.startswith('/dashboard') %}
    </div>
</div>
{% endif %}
<script>
function toggleMobile() {
    const sidebar = document.getElementById('mobileSidebar');
    const overlay = document.getElementById('mobileOverlay');
    sidebar.classList.toggle('show');
    overlay.classList.toggle('hidden');
}
</script>
{% block scripts %}{% endblock %}
</body>
</html>
